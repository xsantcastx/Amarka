<div class="min-h-screen bg-ts-bg md:flex">
  <app-admin-sidebar class="hidden md:block"></app-admin-sidebar>

  <div class="flex-1 md:pl-64">
    <div class="relative overflow-hidden">
      <div class="absolute -top-24 right-0 h-56 w-56 rounded-full bg-ts-accent/15 blur-3xl"></div>
      <div class="absolute -top-12 right-40 h-40 w-40 rounded-full bg-ts-ink/5 blur-3xl"></div>
      <div class="bg-ts-paper/90 backdrop-blur border-b border-ts-line">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
          <div class="flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center gap-3">
              <a routerLink="/admin" class="text-ts-ink hover:text-ts-accent transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
              </a>
              <div>
                <h1 class="text-2xl font-semibold text-ts-ink">{{ 'admin.gallery.title' | translate }}</h1>
                <p class="text-sm text-ts-ink-soft">{{ 'admin.gallery.subtitle' | translate }}</p>
              </div>
            </div>
            <button
              (click)="openUploadModal()"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-ts-accent text-ts-ink border border-ts-accent/60 text-sm font-semibold hover:bg-ts-accent/90 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              {{ 'admin.gallery.actions.upload' | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6">
      @if (successMessage) {
        <div class="rounded-2xl border border-emerald-200 bg-emerald-50/80 px-4 py-3 text-sm text-emerald-700">
          {{ successMessage | translate: successMessageParams }}
        </div>
      }

      @if (errorMessage) {
        <div class="rounded-2xl border border-rose-200 bg-rose-50/80 px-4 py-3 text-sm text-rose-700">
          {{ errorMessage | translate: errorMessageParams }}
        </div>
      }

      <div class="grid gap-4 sm:grid-cols-3">
        <div class="bg-ts-paper border border-ts-line rounded-2xl px-4 py-3">
          <p class="text-xs uppercase tracking-wide text-ts-ink-soft">{{ 'admin.gallery.stats.images' | translate }}</p>
          <p class="text-2xl font-semibold text-ts-ink mt-2">{{ galleryMediaCount }}</p>
        </div>
        <div class="bg-ts-paper border border-ts-line rounded-2xl px-4 py-3">
          <p class="text-xs uppercase tracking-wide text-ts-ink-soft">{{ 'admin.gallery.stats.projects' | translate }}</p>
          <p class="text-2xl font-semibold text-ts-ink mt-2">{{ projectCount }}</p>
        </div>
        <div class="bg-ts-paper border border-ts-line rounded-2xl px-4 py-3">
          <p class="text-xs uppercase tracking-wide text-ts-ink-soft">{{ 'admin.gallery.stats.tags' | translate }}</p>
          <p class="text-2xl font-semibold text-ts-ink mt-2">{{ tagCount }}</p>
        </div>
      </div>

      <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-sm p-4 space-y-4">
        <div class="flex flex-wrap gap-2">
          <button
            type="button"
            (click)="selectedTag = 'all'"
            class="inline-flex items-center gap-2 px-4 py-2 rounded-full border text-sm font-semibold transition-colors"
            [ngClass]="{
              'bg-ts-accent/15 text-ts-ink border-ts-accent shadow-sm': selectedTag === 'all',
              'bg-ts-bg-soft text-ts-ink border-ts-line hover:border-ts-accent/60 hover:bg-ts-accent/5': selectedTag !== 'all'
            }">
            {{ 'admin.gallery.filters.all' | translate }}
            <span class="text-xs" [ngClass]="{ 'text-ts-ink/70': selectedTag === 'all', 'text-ts-ink-soft': selectedTag !== 'all' }">
              {{ getTagCount('all') }}
            </span>
          </button>
          @for (tag of availableTags; track tag.id) {
            <button
              type="button"
              (click)="selectedTag = tag.slug"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-full border text-sm font-semibold transition-colors"
              [ngClass]="{
                'bg-ts-accent/15 text-ts-ink border-ts-accent shadow-sm': selectedTag === tag.slug,
                'bg-ts-bg-soft text-ts-ink border-ts-line hover:border-ts-accent/60 hover:bg-ts-accent/5': selectedTag !== tag.slug
              }"
              [style.border-color]="selectedTag === tag.slug && tag.color ? tag.color : null">
              @if (tag.icon) {
                <span class="text-base">{{ tag.icon }}</span>
              }
              <span>{{ tag.name }}</span>
              <span class="text-xs" [ngClass]="{ 'text-ts-ink/70': selectedTag === tag.slug, 'text-ts-ink-soft': selectedTag !== tag.slug }">
                {{ getTagCount(tag.slug) }}
              </span>
            </button>
          }
        </div>
        <div class="grid gap-4 lg:grid-cols-[1fr]">
          <div>
            <label class="text-xs uppercase tracking-wide text-ts-ink-soft">{{ 'common.search' | translate }}</label>
            <div class="relative mt-2">
              <svg class="w-5 h-5 text-ts-ink-soft absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M9.5 17a7.5 7.5 0 110-15 7.5 7.5 0 010 15z"></path>
              </svg>
              <input
                type="search"
                [(ngModel)]="searchTerm"
                class="w-full pl-10 pr-4 py-2.5 bg-ts-bg-soft border border-ts-line rounded-xl text-ts-ink placeholder-ts-ink-soft focus:ring-2 focus:ring-ts-accent focus:border-ts-accent"
                [placeholder]="'admin.gallery.filters.search_placeholder' | translate">
            </div>
          </div>
        </div>
      </div>

      @if (isLoading) {
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-sm p-12 text-center text-ts-ink-soft">
          <div class="app-spinner" style="--spinner-size: 72px;"><img src="/Logo Clear.png" alt="Loading" width="96" height="96"></div>
          <p class="mt-4">{{ 'common.loading' | translate }}</p>
        </div>
      }

      @if (!isLoading) {
        <div class="space-y-4">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h2 class="text-2xl font-semibold text-ts-ink">{{ 'admin.gallery.projects.title' | translate }}</h2>
              <p class="text-sm text-ts-ink-soft">{{ 'admin.gallery.projects.subtitle' | translate }}</p>
            </div>
            <div class="text-sm text-ts-ink-soft">
              {{ filteredProjects.length }} {{ (filteredProjects.length === 1 ? 'admin.gallery.projects.project' : 'admin.gallery.projects.projects') | translate }}
            </div>
          </div>

          @if (filteredProjects.length === 0) {
            <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-sm p-10 text-center">
              <div class="flex flex-col items-center justify-center gap-4">
                <svg class="w-16 h-16 text-ts-ink-soft" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
                <div>
                  <p class="text-base font-semibold text-ts-ink">{{ 'admin.gallery.projects.empty_title' | translate }}</p>
                  <p class="text-sm text-ts-ink-soft mt-1">{{ 'admin.gallery.projects.empty_body' | translate }}</p>
                </div>
                <button
                  (click)="openUploadModal()"
                  class="px-4 py-2 rounded-full bg-ts-accent text-ts-ink border border-ts-accent/60 text-sm font-semibold hover:bg-ts-accent/90 transition-colors">
                  {{ 'admin.gallery.actions.upload' | translate }}
                </button>
              </div>
            </div>
          } @else {
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
              @for (project of filteredProjects; track project.id) {
                <article class="group bg-ts-paper border border-ts-line rounded-2xl overflow-hidden shadow-sm hover:border-ts-accent/40 hover:shadow-lg transition-all flex flex-col">
                  <div class="relative aspect-[4/3] bg-ts-bg-soft">
                    <img
                      [src]="project.featuredImage.thumbnailUrl || project.featuredImage.url"
                      [alt]="project.name"
                      class="w-full h-full object-cover">
                    <span class="absolute top-3 left-3 text-xs px-2.5 py-1 rounded-full border border-white/20 bg-ts-ink/70 text-white">
                      {{ project.photoCount }} {{ (project.photoCount === 1 ? 'admin.gallery.projects.photo' : 'admin.gallery.projects.photos') | translate }}
                    </span>
                  </div>
                  <div class="p-5 flex-1 flex flex-col gap-4">
                    <div class="flex items-start justify-between gap-3">
                      <div>
                        <h3 class="text-lg font-semibold text-ts-ink mb-1">{{ project.name }}</h3>
                        @if (project.location) {
                          <p class="text-sm text-ts-ink-soft flex items-center gap-1">
                            <svg class="w-4 h-4 text-ts-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            {{ project.location }}
                          </p>
                        }
                      </div>
                      <button
                        type="button"
                        (click)="openProjectManager(project)"
                        class="px-3 py-2 bg-ts-accent/10 hover:bg-ts-accent/20 border border-ts-accent/30 text-ts-accent rounded-xl text-sm font-semibold transition-colors">
                        {{ 'admin.gallery.actions.manage' | translate }}
                      </button>
                    </div>

                    @if (project.caption) {
                      <p class="text-sm text-ts-ink-soft line-clamp-3">{{ project.caption }}</p>
                    }

                    @if (project.tags.length > 0) {
                      <div class="flex flex-wrap gap-2">
                        @for (tag of project.tags; track tag) {
                          <span class="px-2 py-1 text-xs font-medium bg-ts-bg-soft border border-ts-line text-ts-ink rounded-full capitalize">
                            {{ tag }}
                          </span>
                        }
                      </div>
                    }

                    @if (getProjectRelatedServices(project).length > 0) {
                      <div class="space-y-1">
                        <p class="text-xs font-medium text-ts-ink-soft uppercase tracking-wide">{{ 'admin.gallery.projects.linked_services' | translate }}</p>
                        <div class="flex flex-wrap gap-1.5">
                          @for (service of getProjectRelatedServices(project); track service.id) {
                            <span class="px-2 py-1 text-xs bg-ts-accent/10 border border-ts-accent/20 text-ts-accent rounded-full">
                              {{ service.title }}
                            </span>
                          }
                        </div>
                      </div>
                    }
                  </div>
                </article>
              }
            </div>
          }
        </div>
      }
    </div>

    @if (showProjectManager && projectToManage) {
      <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50" (click)="closeProjectManagerWithConfirm()">
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col" (click)="$event.stopPropagation()">
          <div class="px-6 py-4 border-b border-ts-line bg-ts-bg-soft/60 flex items-start justify-between">
            <div>
              <p class="text-xs uppercase tracking-wide text-ts-ink-soft">{{ 'admin.gallery.project_manager.eyebrow' | translate }}</p>
              <h2 class="text-xl font-semibold text-ts-ink">{{ projectToManage.name }}</h2>
              <div class="mt-2 flex flex-wrap items-center gap-3 text-sm text-ts-ink-soft">
                <span class="inline-flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                  {{ projectToManage.photoCount }} {{ (projectToManage.photoCount === 1 ? 'admin.gallery.projects.photo' : 'admin.gallery.projects.photos') | translate }}
                </span>
                @if (projectToManage.location) {
                  <span class="inline-flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    {{ projectToManage.location }}
                  </span>
                }
              </div>
            </div>
            <button (click)="closeProjectManagerWithConfirm()" class="p-2 rounded-lg bg-ts-paper border border-ts-line text-ts-ink hover:border-ts-accent transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <div class="flex-1 overflow-y-auto p-6 space-y-6">
            @if (warningMessage) {
              <div class="rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700">
                {{ warningMessage | translate: warningMessageParams }}
              </div>
            }
            <form [formGroup]="projectForm" (ngSubmit)="saveProjectSettings()" class="space-y-6">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                @if (mediaToEdit) {
                  <div class="lg:col-span-2">
                    <label for="editAltText" class="block text-sm font-semibold text-ts-ink mb-2">
                      {{ 'admin.gallery.fields.project_name' | translate }}
                      <span class="text-rose-500">*</span>
                    </label>
                    <input
                      type="text"
                      id="editAltText"
                      [value]="mediaToEdit.altText"
                      (input)="onAltTextChange($event)"
                      [placeholder]="'admin.gallery.fields.project_name_placeholder' | translate"
                      class="w-full px-4 py-3 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft">
                    <p class="mt-2 text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.project_name_help' | translate }}</p>
                  </div>
                }

                <div class="lg:col-span-2">
                  <label for="projectDescription" class="block text-sm font-semibold text-ts-ink mb-2">
                    {{ 'admin.gallery.fields.description' | translate }}
                  </label>
                  <textarea
                    id="projectDescription"
                    formControlName="caption"
                    rows="4"
                    [placeholder]="'admin.gallery.fields.description_placeholder' | translate"
                    class="w-full px-4 py-3 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft resize-none"></textarea>
                  <p class="mt-2 text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.description_help' | translate }}</p>
                </div>

                <div class="lg:col-span-2 space-y-3">
                  <div class="flex items-center justify-between">
                    <label class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.fields.tags' | translate }}</label>
                    <span class="text-xs font-semibold text-ts-accent bg-ts-accent/10 px-2 py-1 rounded-full">
                      {{ 'admin.gallery.fields.tags_selected' | translate:{ count: projectForm.value.tags?.length || 0 } }}
                    </span>
                  </div>
                  <div class="flex flex-col sm:flex-row gap-2">
                    <input
                      type="text"
                      [(ngModel)]="quickTagInputs.project"
                      [ngModelOptions]="{ standalone: true }"
                      [placeholder]="'admin.gallery.fields.quick_tags_placeholder' | translate"
                      class="flex-1 px-4 py-2.5 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft">
                    <button
                      type="button"
                      (click)="addQuickTags('project')"
                      [disabled]="isAddingQuickTags || !(quickTagInputs.project.trim())"
                      class="px-4 py-2.5 bg-ts-accent/15 hover:bg-ts-accent/25 text-ts-ink border border-ts-accent/40 rounded-xl font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                      @if (isAddingQuickTags) {
                        <span>{{ 'admin.gallery.actions.adding' | translate }}</span>
                      } @else {
                        <span>{{ 'admin.gallery.actions.add_tags' | translate }}</span>
                      }
                    </button>
                  </div>
                  <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.quick_tags_help' | translate }}</p>
                  <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                    @for (tag of availableTags; track tag.id) {
                      <label
                        class="relative flex items-center gap-3 p-3 bg-ts-bg-soft border border-ts-line rounded-xl hover:border-ts-accent/40 cursor-pointer transition-colors"
                        [class.border-ts-accent]="isTagSelected(tag.slug, 'project')"
                        [class.bg-ts-accent/5]="isTagSelected(tag.slug, 'project')">
                        <input
                          type="checkbox"
                          [checked]="isTagSelected(tag.slug, 'project')"
                          (change)="toggleTag(tag.slug, $any($event.target).checked, 'project')"
                          class="w-4 h-4 rounded border-ts-line text-ts-accent focus:ring-2 focus:ring-ts-accent/20">
                        @if (tag.icon) {
                          <span class="text-lg" [style.color]="tag.color">{{ tag.icon }}</span>
                        }
                        <span class="text-sm text-ts-ink font-medium flex-1">{{ tag.name }}</span>
                      </label>
                    }
                  </div>
                  <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.tags_help' | translate }}</p>
                </div>

                <div class="lg:col-span-2 space-y-3">
                  <label class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.fields.related_services' | translate }}</label>
                  <div class="max-h-72 overflow-y-auto border border-ts-line rounded-xl bg-ts-bg-soft/40 p-4 space-y-2">
                    @if (services.length === 0) {
                      <div class="text-center py-6 text-sm text-ts-ink-soft">
                        {{ 'admin.gallery.fields.no_services' | translate }}
                      </div>
                    } @else {
                      @for (service of services; track service.id) {
                        <label class="flex items-center gap-3 p-3 bg-ts-paper border border-ts-line/60 rounded-lg cursor-pointer hover:border-ts-accent/30 hover:bg-ts-accent/5 transition-colors">
                          <input
                            type="checkbox"
                            [checked]="isProductSelected(service.id || '', 'project')"
                            (change)="toggleRelatedProduct(service.id || '', $any($event.target).checked, 'project')"
                            class="w-4 h-4 rounded border-ts-line text-ts-accent focus:ring-2 focus:ring-ts-accent/20">
                          <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-ts-ink truncate">{{ service.title }}</p>
                            @if (service.subtitle) {
                              <p class="text-xs text-ts-ink-soft truncate">{{ service.subtitle }}</p>
                            }
                          </div>
                        </label>
                      }
                    }
                  </div>
                  <p class="text-xs text-ts-ink-soft">
                    @if (mediaToEdit) {
                      <span>{{ 'admin.gallery.fields.related_services_help_single' | translate }}</span>
                    } @else {
                      <span>{{ 'admin.gallery.fields.related_services_help_all' | translate }}</span>
                    }
                  </p>
                </div>
              </div>

              <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t border-ts-line">
                <p class="text-xs text-ts-ink-soft max-w-md">
                  @if (mediaToEdit) {
                    <span>{{ 'admin.gallery.project_manager.save_note_single' | translate }}</span>
                  } @else {
                    <span>{{ 'admin.gallery.project_manager.save_note_all' | translate }}</span>
                  }
                </p>
                <button
                  type="submit"
                  [disabled]="isProjectSaving || (projectForm.pristine && !mediaToEdit)"
                  class="inline-flex items-center gap-2 px-5 py-3 rounded-xl bg-ts-accent text-ts-ink border border-ts-accent/60 font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-ts-accent/90">
                  @if (isProjectSaving) {
                    <span>{{ 'admin.gallery.actions.saving' | translate }}</span>
                  } @else {
                    <span>{{ (mediaToEdit ? 'admin.gallery.actions.save_photo' : 'admin.gallery.actions.save_project') | translate }}</span>
                  }
                </button>
              </div>
            </form>
            <div class="flex flex-wrap gap-3">
              <button
                type="button"
                (click)="addPhotosToProject(projectToManage)"
                class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-ts-accent/15 text-ts-ink border border-ts-accent/40 font-semibold hover:bg-ts-accent/25 transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                {{ 'admin.gallery.actions.add_photos' | translate }}
              </button>
              <button
                type="button"
                (click)="requestDeleteProject()"
                class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-rose-50 text-rose-700 border border-rose-200 font-semibold hover:bg-rose-100 transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
                {{ 'admin.gallery.actions.delete_project' | translate }}
              </button>
              <button
                type="button"
                (click)="closeProjectManagerWithConfirm()"
                class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-ts-bg-soft text-ts-ink border border-ts-line font-semibold hover:border-ts-accent/40 transition-colors">
                {{ 'admin.gallery.actions.close' | translate }}
              </button>
            </div>

            <div class="space-y-3">
              <div class="flex flex-wrap items-center justify-between gap-2">
                <h3 class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.project_manager.photos_title' | translate }}</h3>
                <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.project_manager.photos_hint' | translate }}</p>
              </div>
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                @for (image of projectToManage.images; track image.id) {
                  @let isSelected = mediaToEdit?.id === image.id;
                  <div
                    class="bg-ts-paper border rounded-xl overflow-hidden flex flex-col shadow-sm transition-all cursor-pointer"
                    [ngClass]="{
                      'border-ts-accent ring-2 ring-ts-accent/40': isSelected,
                      'border-ts-line hover:border-ts-accent/40': !isSelected
                    }"
                    (click)="selectMediaForEdit(image)">
                    <div class="relative aspect-video bg-ts-bg-soft">
                      <img
                        [src]="image.thumbnailUrl || image.url"
                        [alt]="image.altText || projectToManage.name"
                        class="w-full h-full object-cover">
                      <div class="absolute inset-0 bg-black/40 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center gap-3">
                        <button
                          type="button"
                          (click)="$event.stopPropagation(); selectMediaForEdit(image)"
                          class="p-2 bg-white/90 text-ts-ink rounded-lg hover:bg-white transition-colors"
                          [title]="'admin.gallery.project_manager.edit_photo' | translate">
                          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                          </svg>
                        </button>
                        <button
                          type="button"
                          (click)="$event.stopPropagation(); openDeleteConfirm(image)"
                          class="p-2 bg-rose-500/90 text-white rounded-lg hover:bg-rose-600 transition-colors"
                          [title]="'common.delete' | translate">
                          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                          </svg>
                        </button>
                      </div>
                    </div>
                    <div class="p-4 space-y-2 text-sm text-ts-ink flex-1 flex flex-col">
                      @if (image.altText) {
                        <p class="font-medium text-ts-ink">{{ image.altText }}</p>
                      }
                      @if (image.tags.length > 0) {
                        <div class="flex flex-wrap gap-1">
                          @for (tag of image.tags; track tag) {
                            <span class="px-2 py-0.5 text-xs bg-ts-bg-soft text-ts-ink border border-ts-line rounded-full capitalize">
                              {{ tag }}
                            </span>
                          }
                        </div>
                      }
                      <div class="mt-auto text-xs text-ts-ink-soft flex items-center justify-between">
                        <span>{{ image.width }}x{{ image.height }}px</span>
                        <span>{{ image.uploadedAt | date:'dd/MM/yyyy' }}</span>
                      </div>
                    </div>
                  </div>
                }
              </div>
            </div>
          </div>
        </div>
      </div>
    }

    @if (showUploadModal) {
      <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col" (click)="$event.stopPropagation()">
          <div class="px-6 py-4 border-b border-ts-line bg-ts-bg-soft/60 flex items-start justify-between">
            <div>
              <h2 class="text-xl font-semibold text-ts-ink">{{ 'admin.gallery.upload.title' | translate }}</h2>
              <p class="text-sm text-ts-ink-soft">{{ 'admin.gallery.upload.subtitle' | translate }}</p>
            </div>
            <button (click)="closeUploadModal()" class="p-2 rounded-lg bg-ts-paper border border-ts-line text-ts-ink hover:border-ts-accent transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()" class="flex-1 overflow-y-auto">
            <div class="p-6 space-y-6">
              @if (warningMessage) {
                <div class="rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700">
                  {{ warningMessage | translate: warningMessageParams }}
                </div>
              }

              @if (previewUrls.length > 0) {
                <div class="bg-ts-bg-soft/50 rounded-2xl p-5 space-y-4 border border-ts-line">
                  <div class="flex items-center justify-between gap-3">
                    <div>
                      <h3 class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.upload.selected_images' | translate }}</h3>
                      <p class="text-xs text-ts-ink-soft">
                        {{ previewUrls.length }} {{ (previewUrls.length === 1 ? 'admin.gallery.upload.file_single' : 'admin.gallery.upload.file_plural') | translate }}
                      </p>
                    </div>
                    @if (!isUploading) {
                      <button
                        type="button"
                        (click)="selectedFiles = []; revokeAllPreviewUrls()"
                        class="px-3 py-2 text-xs font-semibold text-rose-700 border border-rose-200 rounded-full hover:bg-rose-50 transition-colors">
                        {{ 'admin.gallery.upload.clear_all' | translate }}
                      </button>
                    }
                  </div>
                  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                    @for (url of previewUrls; track $index) {
                      <div class="relative group rounded-xl overflow-hidden border border-ts-line hover:border-ts-accent/40 transition-all">
                        <div class="aspect-square">
                          <img [src]="url" alt="Preview {{ $index + 1 }}" class="w-full h-full object-cover">
                        </div>
                        @if (!isUploading) {
                          <button
                            type="button"
                            (click)="removeImage($index)"
                            class="absolute top-2 right-2 p-1.5 bg-white/90 text-rose-700 rounded-lg opacity-0 group-hover:opacity-100 transition-all">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                          </button>
                        }
                        <div class="absolute bottom-0 inset-x-0 bg-gradient-to-t from-black/70 via-black/40 to-transparent p-3">
                          <p class="text-xs text-white font-medium truncate">{{ selectedFiles[$index]?.name }}</p>
                          @if (selectedFiles[$index]?.size) {
                            <p class="text-[10px] text-white/70">{{ (selectedFiles[$index].size / 1024 / 1024).toFixed(2) }} MB</p>
                          }
                        </div>
                      </div>
                    }
                  </div>
                </div>
              }

              <div class="space-y-3">
                <label class="block text-sm font-semibold text-ts-ink">
                  {{ 'admin.gallery.upload.image_files' | translate }}
                  <span class="text-rose-500">*</span>
                </label>
                <div class="relative">
                  <input
                    type="file"
                    id="imageFile"
                    (change)="onCoverSelected($event)"
                    accept="image/*"
                    multiple
                    [disabled]="isUploading"
                    class="absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed">
                  <div class="border-2 border-dashed border-ts-line rounded-2xl p-8 text-center bg-ts-bg-soft/60 hover:border-ts-accent/50 hover:bg-ts-accent/5 transition-colors">
                    <div class="w-12 h-12 mx-auto mb-3 rounded-full bg-ts-accent/10 flex items-center justify-center">
                      <svg class="w-6 h-6 text-ts-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </div>
                    <p class="text-sm font-medium text-ts-ink">{{ 'admin.gallery.upload.drop_title' | translate }}</p>
                    <p class="text-xs text-ts-ink-soft mt-1">{{ 'admin.gallery.upload.drop_subtitle' | translate }}</p>
                    <p class="text-xs text-ts-ink-soft mt-1">{{ 'admin.gallery.upload.drop_hint' | translate }}</p>
                  </div>
                </div>
              </div>

              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="space-y-3">
                  <label for="altText" class="block text-sm font-semibold text-ts-ink">
                    {{ 'admin.gallery.fields.project_name' | translate }}
                    <span class="text-rose-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="altText"
                    formControlName="altText"
                    [placeholder]="'admin.gallery.fields.project_name_placeholder' | translate"
                    [disabled]="isUploading"
                    class="w-full px-4 py-3 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft disabled:opacity-50 disabled:cursor-not-allowed">
                  <p class="text-xs text-ts-ink-soft">
                    @if (selectedFiles.length > 1) {
                      <span>{{ 'admin.gallery.fields.project_name_help_multi' | translate:{ count: selectedFiles.length } }}</span>
                    } @else {
                      <span>{{ 'admin.gallery.fields.project_name_help_single' | translate }}</span>
                    }
                  </p>
                </div>

                <div class="space-y-3">
                  <label for="caption" class="block text-sm font-semibold text-ts-ink">
                    {{ 'admin.gallery.fields.description' | translate }}
                  </label>
                  <textarea
                    id="caption"
                    formControlName="caption"
                    rows="3"
                    [placeholder]="'admin.gallery.fields.description_placeholder' | translate"
                    [disabled]="isUploading"
                    class="w-full px-4 py-3 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft resize-none disabled:opacity-50 disabled:cursor-not-allowed"></textarea>
                  <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.description_help' | translate }}</p>
                </div>
              </div>
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <label class="text-sm font-semibold text-ts-ink">
                    {{ 'admin.gallery.fields.tags' | translate }}
                    <span class="text-rose-500">*</span>
                  </label>
                  <span class="text-xs font-semibold text-ts-accent bg-ts-accent/10 px-2 py-1 rounded-full">
                    {{ 'admin.gallery.fields.tags_selected' | translate:{ count: getSelectedTagsCount('upload') } }}
                  </span>
                </div>

                <div class="bg-ts-bg-soft/50 border border-ts-line rounded-2xl p-4 space-y-3">
                  <div class="flex items-center gap-2">
                    <svg class="w-4 h-4 text-ts-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    <h4 class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.fields.custom_tags_title' | translate }}</h4>
                  </div>
                  <div class="flex flex-col sm:flex-row gap-2">
                    <input
                      type="text"
                      [(ngModel)]="quickTagInputs.upload"
                      [ngModelOptions]="{standalone: true}"
                      [placeholder]="'admin.gallery.fields.custom_tags_placeholder' | translate"
                      (keydown.enter)="addQuickTags('upload'); $event.preventDefault()"
                      [disabled]="isUploading"
                      class="flex-1 px-4 py-2.5 bg-ts-bg-soft border border-ts-line rounded-xl focus:ring-2 focus:ring-ts-accent focus:border-ts-accent text-ts-ink placeholder-ts-ink-soft disabled:opacity-50 disabled:cursor-not-allowed">
                    <button
                      type="button"
                      (click)="addQuickTags('upload')"
                      [disabled]="isUploading || !quickTagInputs.upload.trim()"
                      class="px-4 py-2.5 bg-ts-accent text-ts-ink border border-ts-accent/60 rounded-xl font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-ts-accent/90">
                      {{ 'admin.gallery.actions.add_tags' | translate }}
                    </button>
                  </div>
                  <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.custom_tags_help' | translate }}</p>
                </div>

                <div>
                  <p class="text-xs font-semibold uppercase tracking-wide text-ts-ink-soft mb-3">{{ 'admin.gallery.fields.select_existing_tags' | translate }}</p>
                  <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                    @for (tag of availableTags; track tag.id) {
                      <label
                        class="relative flex items-center gap-3 p-3 bg-ts-bg-soft border border-ts-line rounded-xl cursor-pointer transition-colors hover:border-ts-accent/40"
                        [class.border-ts-accent]="isTagSelected(tag.slug, 'upload')"
                        [class.bg-ts-accent/5]="isTagSelected(tag.slug, 'upload')">
                        <input
                          type="checkbox"
                          [checked]="isTagSelected(tag.slug, 'upload')"
                          (change)="toggleTag(tag.slug, $any($event.target).checked, 'upload')"
                          class="w-4 h-4 rounded border-ts-line text-ts-accent focus:ring-2 focus:ring-ts-accent/20">
                        @if (tag.icon) {
                          <span class="text-lg">{{ tag.icon }}</span>
                        }
                        <span class="text-sm font-medium text-ts-ink flex-1">{{ tag.name }}</span>
                      </label>
                    }
                  </div>
                </div>
                <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.tags_help' | translate }}</p>
              </div>

              <div class="space-y-3">
                <div class="flex items-center justify-between">
                  <label class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.fields.related_services' | translate }}</label>
                  @if (uploadForm.value.relatedProductIds && uploadForm.value.relatedProductIds.length > 0) {
                    <span class="text-xs font-semibold text-ts-accent bg-ts-accent/10 px-2 py-1 rounded-full">
                      {{ uploadForm.value.relatedProductIds.length }}
                    </span>
                  }
                </div>
                <div class="max-h-72 overflow-y-auto border border-ts-line rounded-xl bg-ts-bg-soft/40 p-4 space-y-2">
                  @if (services.length === 0) {
                    <div class="text-center py-6 text-sm text-ts-ink-soft">
                      {{ 'admin.gallery.fields.no_services' | translate }}
                    </div>
                  } @else {
                    @for (service of services; track service.id) {
                      <label class="flex items-center gap-3 p-3 bg-ts-paper border border-ts-line/60 rounded-lg cursor-pointer hover:border-ts-accent/30 hover:bg-ts-accent/5 transition-colors">
                        <input
                          type="checkbox"
                          [checked]="isProductSelected(service.id || '', 'upload')"
                          (change)="toggleRelatedProduct(service.id || '', $any($event.target).checked, 'upload')"
                          class="w-4 h-4 rounded border-ts-line text-ts-accent focus:ring-2 focus:ring-ts-accent/20">
                        <div class="flex-1 min-w-0">
                          <p class="text-sm font-medium text-ts-ink truncate">{{ service.title }}</p>
                          @if (service.subtitle) {
                            <p class="text-xs text-ts-ink-soft truncate">{{ service.subtitle }}</p>
                          }
                        </div>
                      </label>
                    }
                  }
                </div>
                <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.fields.related_services_help' | translate }}</p>
              </div>

              @if (isUploading && uploadProgress > 0) {
                <div class="bg-ts-bg-soft/60 border border-ts-line rounded-2xl p-5 space-y-4">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm font-semibold text-ts-ink">{{ 'admin.gallery.upload.uploading' | translate }}</p>
                      <p class="text-xs text-ts-ink-soft">{{ 'admin.gallery.upload.progress' | translate:{ current: uploadedCount, total: totalToUpload } }}</p>
                    </div>
                    <span class="text-lg font-semibold text-ts-accent">{{ uploadProgress }}%</span>
                  </div>
                  <div class="w-full bg-ts-bg rounded-full h-2 overflow-hidden border border-ts-line">
                    <div
                      class="bg-ts-accent h-full rounded-full transition-all duration-500 ease-out"
                      [style.width.%]="uploadProgress"></div>
                  </div>
                </div>
              }
            </div>

            <div class="border-t border-ts-line bg-ts-bg-soft/60 px-6 py-4">
              <div class="flex flex-col sm:flex-row gap-3">
                <button
                  type="submit"
                  [disabled]="isSaving || selectedFiles.length === 0"
                  class="flex-1 inline-flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-ts-accent text-ts-ink border border-ts-accent/60 font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-ts-accent/90">
                  @if (isSaving) {
                    <span>{{ 'admin.gallery.actions.saving' | translate }}</span>
                  } @else {
                    @if (selectedFiles.length > 1) {
                      <span>{{ 'admin.gallery.upload.button_multi' | translate:{ count: selectedFiles.length } }}</span>
                    } @else if (selectedFiles.length === 1) {
                      <span>{{ 'admin.gallery.upload.button_single' | translate }}</span>
                    } @else {
                      <span>{{ 'admin.gallery.upload.button_empty' | translate }}</span>
                    }
                  }
                </button>
                <button
                  type="button"
                  (click)="closeUploadModal()"
                  [disabled]="isSaving"
                  class="flex-1 sm:flex-none sm:px-6 py-3 rounded-xl bg-ts-paper border border-ts-line text-ts-ink font-semibold hover:border-ts-accent/40 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                  {{ 'common.cancel' | translate }}
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    }

    @if (showCloseConfirmation) {
      <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]" (click)="cancelCloseModal()">
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-2xl max-w-md w-full overflow-hidden" (click)="$event.stopPropagation()">
          <div class="p-6 text-center">
            <div class="w-14 h-14 mx-auto mb-4 rounded-full bg-amber-100 flex items-center justify-center">
              <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-ts-ink mb-2">{{ 'admin.gallery.confirm.close_title' | translate }}</h3>
            <p class="text-sm text-ts-ink-soft mb-6">{{ 'admin.gallery.confirm.close_body' | translate }}</p>
            <div class="flex gap-3">
              <button
                (click)="cancelCloseModal()"
                class="flex-1 py-2.5 px-4 bg-ts-accent text-ts-ink border border-ts-accent/60 rounded-xl font-semibold hover:bg-ts-accent/90 transition-colors">
                {{ 'admin.gallery.confirm.close_continue' | translate }}
              </button>
              <button
                (click)="confirmCloseModal()"
                class="flex-1 py-2.5 px-4 bg-ts-paper border border-ts-line text-ts-ink rounded-xl font-semibold hover:border-rose-300 hover:text-rose-600 transition-colors">
                {{ 'admin.gallery.confirm.close_discard' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    }

    @if (showProjectDeleteConfirm && projectToManage) {
      <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]" (click)="closeProjectDeleteConfirm()">
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-2xl max-w-md w-full overflow-hidden" (click)="$event.stopPropagation()">
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center">
                <svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-ts-ink">{{ 'admin.gallery.confirm.project_delete_title' | translate }}</h3>
                <p class="text-sm text-ts-ink-soft">{{ 'admin.gallery.confirm.project_delete_body' | translate:{ name: projectToManage.name, count: projectToManage.photoCount } }}</p>
              </div>
            </div>
            <div class="flex gap-3">
              <button
                (click)="confirmDeleteProject()"
                class="flex-1 py-2.5 px-4 bg-rose-600 text-white rounded-xl font-semibold hover:bg-rose-700 transition-colors">
                {{ 'common.delete' | translate }}
              </button>
              <button
                (click)="closeProjectDeleteConfirm()"
                class="flex-1 py-2.5 px-4 bg-ts-paper border border-ts-line text-ts-ink rounded-xl font-semibold hover:border-ts-accent/40 transition-colors">
                {{ 'common.cancel' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    }

    @if (showDeleteConfirm) {
      <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50" (click)="closeDeleteConfirm()">
        <div class="bg-ts-paper border border-ts-line rounded-2xl shadow-2xl max-w-md w-full overflow-hidden" (click)="$event.stopPropagation()">
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
              <div class="w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center">
                <svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-ts-ink">{{ 'admin.gallery.confirm.delete_title' | translate }}</h3>
                <p class="text-sm text-ts-ink-soft">{{ 'admin.gallery.confirm.delete_body' | translate }}</p>
              </div>
            </div>

            <div class="mb-4 rounded-xl overflow-hidden border border-ts-line">
              <img [src]="mediaToDelete!.thumbnailUrl || mediaToDelete!.url" [alt]="mediaToDelete!.altText" class="w-full h-40 object-cover">
              <div class="p-3 bg-ts-bg-soft/60 space-y-1">
                @if (mediaToDelete!.altText) {
                  <p class="text-sm font-medium text-ts-ink">{{ mediaToDelete!.altText }}</p>
                }
                @if (mediaToDelete!.tags.length > 0) {
                  <div class="flex flex-wrap gap-1">
                    @for (tag of mediaToDelete!.tags; track tag) {
                      <span class="text-xs px-2 py-1 bg-ts-bg-soft text-ts-ink border border-ts-line rounded-full capitalize">{{ tag }}</span>
                    }
                  </div>
                }
              </div>
            </div>

            <div class="flex gap-3">
              <button
                (click)="confirmDelete()"
                class="flex-1 py-2.5 px-4 bg-rose-600 text-white rounded-xl font-semibold hover:bg-rose-700 transition-colors">
                {{ 'common.delete' | translate }}
              </button>
              <button
                (click)="closeDeleteConfirm()"
                class="flex-1 py-2.5 px-4 bg-ts-paper border border-ts-line text-ts-ink rounded-xl font-semibold hover:border-ts-accent/40 transition-colors">
                {{ 'common.cancel' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>
